# ModInt 利用ガイド

## 概要

ModInt は、int 型の値に対して剰余演算（modulo 演算）を効率的に行うためのイミュータブルなラッパークラスです。
競技プログラミングにおいて、大きな数値の計算結果を特定の素数で割った余りを求める問題で使用します。

## 特徴

- イミュータブル（不変）設計で安全性を確保
- デフォルト mod 値として 998244353（FFT フレンドリー素数）を採用
- フェルマーの小定理を利用した除算（逆元計算）
- 繰り返し二乗法による高速なべき乗計算
- 2による除算を事前計算により O(1) で実行
- final クラスで継承を禁止し、意図しない拡張を防止

## 依存関係

Java 標準ライブラリのみを使用（外部ライブラリ不要）

## 主な機能（メソッド一覧）

### 1. コンストラクタ系メソッド

| メソッド                         | 戻り値の型 | 説明                                       |
|------------------------------|-------|------------------------------------------|
| `ModInt()`                   | -     | デフォルトコンストラクタ。value=0, mod=998244353 で初期化 |
| `ModInt(int value)`          | -     | 指定した値で初期化。mod=998244353 を使用              |
| `ModInt(int value, int mod)` | -     | 値と mod を指定して初期化。inv2（2の逆元）を事前計算          |

### 2. 算術演算系メソッド

| メソッド                | 戻り値の型  | 説明                                                     |
|---------------------|--------|--------------------------------------------------------|
| `add(ModInt other)` | ModInt | モジュロ加算を実行。(this + other) % mod を返す                     |
| `sub(ModInt other)` | ModInt | モジュロ減算を実行。(this - other + mod) % mod を返す               |
| `mul(ModInt other)` | ModInt | モジュロ乗算を実行。(this * other) % mod を返す                     |
| `div(ModInt other)` | ModInt | モジュロ除算を実行。this * other^(-1) % mod を返す。除数が2の場合は最適化経路を使用 |
| `pow(int exp)`      | ModInt | モジュロべき乗を実行。this^exp % mod を返す                          |

### 3. アクセサ系メソッド

| メソッド         | 戻り値の型  | 説明              |
|--------------|--------|-----------------|
| `value()`    | int    | 内部に保持している値を取得   |
| `mod()`      | int    | 使用している mod 値を取得 |
| `toString()` | String | 内部値を文字列表現で返す    |

### 4. 内部ヘルパーメソッド

| メソッド                    | 戻り値の型 | 説明                           |
|-------------------------|-------|------------------------------|
| `modPow(int n, long k)` | int   | 繰り返し二乗法によるべき乗計算。private メソッド |

## 利用例

```java
// 基本的な使用例
ModInt a = new ModInt(1000000000);
ModInt b = new ModInt(2000000000);

// 加算
ModInt sum = a.add(b);
System.out.println(sum);  // (10^9 + 2*10^9) % 998244353

// 減算
ModInt diff = a.sub(b);
System.out.println(diff);  // (10^9 - 2*10^9 + mod) % 998244353

// 乗算
ModInt prod = a.mul(b);
System.out.println(prod);  // (10^9 * 2*10^9) % 998244353

// 除算（逆元を使用）
ModInt x = new ModInt(10);
ModInt y = new ModInt(3);
ModInt quotient = x.div(y);  // 10 * 3^(-1) % mod
System.out.println(quotient);

// 2による除算は最適化される
ModInt half = x.div(new ModInt(2));
System.out.println(half);  // 5

// べき乗計算
ModInt base = new ModInt(2);
ModInt power = base.pow(10);  // 2^10 = 1024
System.out.println(power);

// カスタム mod の使用
int customMod = 1000000007;
ModInt c = new ModInt(123456789, customMod);
ModInt d = new ModInt(987654321, customMod);
ModInt result = c.mul(d);
System.out.println("value: " + result.value());
System.out.println("mod: " + result.mod());
```

## 注意事項

- mod 値は素数である必要があります。除算操作はフェルマーの小定理（a^(p-1) ≡ 1 (mod p)）を利用しているためです
- 演算を行う2つの ModInt オブジェクトは同じ mod 値を持つことを前提としています。異なる mod 間の演算は想定されておらず、チェックも行われません
- 負数をコンストラクタに渡した場合、そのまま内部に格納されます。演算時に mod による正規化が行われますが、value()
	で取得する値は負の可能性があります
- イミュータブル設計のため、全ての演算は新しい ModInt オブジェクトを返します。元のオブジェクトは変更されません
- 乗算時は long にキャストして計算を行い、int 範囲でのオーバーフローを防いでいます
- 2による除算は頻繁に使用されるため、コンストラクタで2の逆元を事前計算して最適化しています

## パフォーマンス特性

- **加算・減算・乗算の時間計算量**: O(1)
- **除算の時間計算量**:
	- 除数が2の場合: O(1)（事前計算済み逆元を使用）
	- 一般の場合: O(log mod)（フェルマーの小定理による逆元計算）
- **べき乗の時間計算量**: O(log exp)（繰り返し二乗法）
- **空間計算量**: O(1)（インスタンスあたり固定サイズ）

## バージョン情報

| バージョン番号       | 年月日        | 詳細                              |
|:--------------|:-----------|:--------------------------------|
| **バージョン 1.0** | 2025-10-13 | 初版リリース。基本的な算術演算、除算（逆元）、べき乗をサポート |

### バージョン管理について

バージョン番号は2桁で管理します：

- 1桁目（メジャーバージョン）: メソッドの追加や機能拡張があった場合に更新
- 2桁目（マイナーバージョン）: 誤字修正、バグ修正、マイクロ高速化などの小さな更新があった場合に更新F