# `BinarySearchTree<T extends Comparable<T>>` 利用ガイド

## 概要

`java.util.Collection` インターフェースを実装した、ジェネリクス対応の二分探索木クラスです。順序付けられた要素の集合を効率的に管理することを目的としています。

## 特徴

- **`Collection`準拠**: `java.util.Collection`インターフェースを実装しており、標準的なコレクションとして扱えます。
- **カスタマイズ可能な順序**: デフォルトでは要素の自然順序に従いますが、コンストラクタで`Comparator`
	を指定することで、任意の順序で要素を管理できます。
- **近傍探索機能**: 指定した値より大きい/小さい、または等しい要素の中で最も近いものを探索するメソッド (`floor`,
	`ceiling`, `lower`, `higher`) を提供します。
- **非平衡木**: この実装は**平衡二分探索木ではありません**。データの挿入順によっては木が偏り、パフォーマンスが線形的に悪化する可能性があります。

## 依存関係

- 標準Javaライブラリ (`java.util`パッケージなど) のみに依存します。

## 主な機能（メソッド一覧）

### 1. コンストラクタ

| メソッド                                           | 戻り値の型 | 説明                               |
|------------------------------------------------|-------|----------------------------------|
| `BinarySearchTree()`                           | -     | 要素の自然順序付けを使用する空の二分探索木を作成します。     |
| `BinarySearchTree(Comparator<? super T> comp)` | -     | 指定されたコンパレータに従って順序付けを行う空の木を作成します。 |

### 2. 基本操作系メソッド

| メソッド                         | 戻り値の型     | 説明                            |
|------------------------------|-----------|-------------------------------|
| `int size()`                 | `int`     | 木に含まれる要素数を返します。               |
| `boolean isEmpty()`          | `boolean` | 木が空である場合に`true`を返します。         |
| `boolean contains(Object o)` | `boolean` | 指定された要素が含まれている場合に`true`を返します。 |
| `boolean add(T t)`           | `boolean` | 指定された要素を木に追加します。              |
| `boolean remove(Object o)`   | `boolean` | 指定された要素を木から削除します。             |
| `void clear()`               | `void`    | 全ての要素を木から削除します。               |

### 3. 一括操作系メソッド

| メソッド                                        | 戻り値の型     | 説明                                        |
|---------------------------------------------|-----------|-------------------------------------------|
| `boolean containsAll(Collection<?> c)`      | `boolean` | 指定されたコレクションの全ての要素が木に含まれている場合に`true`を返します。 |
| `boolean addAll(Collection<? extends T> c)` | `boolean` | 指定されたコレクションの全ての要素を木に追加します。                |
| `boolean removeAll(Collection<?> c)`        | `boolean` | 指定されたコレクションに含まれる全ての要素を木から削除します。           |
| `boolean retainAll(Collection<?> c)`        | `boolean` | 指定されたコレクションに含まれる要素のみを保持し、他を削除します。         |

### 4. 変換・走査系メソッド

| メソッド                        | 戻り値の型         | 説明                                |
|-----------------------------|---------------|-----------------------------------|
| `Iterator<T> iterator()`    | `Iterator<T>` | 木の要素を昇順に走査するイテレータを返します。           |
| `Object[] toArray()`        | `Object[]`    | 木の全ての要素を昇順に含む配列を返します。             |
| `<T1> T1[] toArray(T1[] a)` | `<T1> T1[]`   | 木の全ての要素を昇順に含む配列を返します（指定された配列を使用）。 |
| `Stream<T> stream()`        | `Stream<T>`   | 木の要素を昇順に処理するシーケンシャル`Stream`を返します。 |

### 5. 近傍探索系メソッド

| メソッド               | 戻り値の型 | 説明                                     |
|--------------------|-------|----------------------------------------|
| `T higher(T key)`  | `T`   | 指定されたキーより大きい最小の要素を返します。存在しない場合は`null`。 |
| `T ceiling(T key)` | `T`   | 指定されたキー以上の最小の要素を返します。存在しない場合は`null`。   |
| `T lower(T key)`   | `T`   | 指定されたキーより小さい最大の要素を返します。存在しない場合は`null`。 |
| `T floor(T key)`   | `T`   | 指定されたキー以下の最大の要素を返します。存在しない場合は`null`。   |

## 利用例

（省略）

## 注意事項

- `null`要素の追加は許可されていません。
- このクラスはスレッドセーフではありません。複数のスレッドから同時に変更すると、予期しない動作を引き起こす可能性があります。
- `removeAll`や`retainAll`などの一括操作は、内部で要素ごとの探索と削除を繰り返すため、要素数が多い場合には非効率になる可能性があります。

## パフォーマンス特性

- **時間計算量**:
	- `add`, `remove`, `contains` および近傍探索メソッド:
		- 平均ケース: $O(\log N)$
		- 最悪ケース: $O(N)$
	- `size`, `isEmpty`: $O(1)$
- **空間計算量**: $O(N)$ (Nは要素数)

## バージョン情報

| バージョン番号       | 年月日        | 詳細                                                       |
|:--------------|:-----------|:---------------------------------------------------------|
| **バージョン 1.0** | 2025-09-25 | `remove`メソッドにおいて、子が2つあるノードを削除する際の`parent`ポインタ更新漏れのバグを修正。 |

### バージョン管理について

バージョン番号は2桁で管理します：

- 1桁目（メジャーバージョン）: メソッドの追加や機能拡張があった場合に更新
- 2桁目（マイナーバージョン）: 誤字修正、バグ修正、マイクロ高速化などの小さな更新があった場合に更新