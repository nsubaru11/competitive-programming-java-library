# FastPrinter 利用ガイド

## 概要

`FastPrinter`は、競技プログラミング向けに設計された高速出力クラスです。  
内部バッファと低レベルなバイト操作を利用して`OutputStream`への書き込みを効率化し、標準の`PrintStream`よりも高速な処理を実現します。
以前のバージョンで別クラスだった `ContestPrinter` の機能（配列やコレクションの一括出力、変換関数適用など）が統合されており、高い記述性とパフォーマンスを両立しています。

## 特徴

- **効率的な出力**: 内部バッファを利用して効率的に出力します。
- **高速性の重視**: `sun.misc.Unsafe`の利用や最適化された数値変換ロジックなど、最小限のオブジェクト生成でパフォーマンスを追求しています。
- **メソッドチェーン**: `print()`や`println()`が自身のインスタンスを返すため、`fp.print(a).print(" ").println(b)`のように記述できます。
- **多機能出力**: プリミティブ型の配列、オブジェクト配列、`Iterable`、2次元配列など、多彩なデータ構造の出力に対応します。
- **関数変換**: 出力する要素を、指定した関数でその場で変換しながら出力できます。
- **文字コード**: `ASCII` 範囲内の文字出力のみをサポートします。

## 依存関係

- Java 標準の入出力ライブラリ（`OutputStream`）
- `sun.misc.Unsafe` ライブラリ
- `java.util.function.*`

## 主な機能

### 基本的な出力メソッド

| メソッド               | 説明                 |
|--------------------|--------------------|
| `print(value)`     | 指定された値を改行なしで出力します。 |
| `println()`        | 改行のみを出力します。        |
| `println(value)`   | 指定された値を改行付きで出力します。 |
| `printf(fmt, ...)` | フォーマット付き出力を行います。   |

### 配列・コレクション出力

| メソッド                             | 説明                             |
|----------------------------------|--------------------------------|
| `print(int[] arr)`               | int配列を半角スペース区切りで出力（改行なし）       |
| `println(int[] arr)`             | int配列を各要素改行区切りで出力（改行付き）        |
| `println(int[][] arr2d)`         | 2次元int配列を行列形式で出力               |
| `print(Iterable<T> iter)`        | Iterableの要素を半角スペース区切りで出力（改行なし） |
| `print(U[] arr, char delimiter)` | 指定した区切り文字で配列を出力                |

### 関数変換付き出力

| メソッド                                          | 説明                       |
|-----------------------------------------------|--------------------------|
| `print(int[] arr, IntFunction<T> function)`   | 各要素を関数で変換して出力（半角スペース区切り） |
| `println(Iterable<T> iter, Function<T, U> f)` | 各要素を関数で変換して出力（各要素改行付き）   |

### 制御メソッド

| メソッド      | 説明                                                       |
|-----------|----------------------------------------------------------|
| `flush()` | 内部バッファの内容を強制的に出力ストリームに書き込みます。                            |
| `close()` | バッファをフラッシュした後、出力ストリームを閉じます（`try-with-resources`で自動呼び出し）。 |

## 利用例

```java
try (FastPrinter fp = new FastPrinter()) {
    int[] a = {1, 2, 3};
    fp.println("Result:").println(a); // 配列の出力
    
    fp.print(10).print(" ").println(20); // メソッドチェーン
    
    List<Integer> list = Arrays.asList(4, 5, 6);
    fp.print(list, x -> x * 2); // 変換しながら出力
}
```

## 注意事項

- `ASCII` 範囲外の文字はサポートされていません。
- `autoFlush`が`false`の場合（デフォルト）、最後に`flush()`または`close()`を呼び出す必要があります。
- 統合に伴い、以前の `ContestPrinter` は削除されました。

## バージョン情報

| バージョン番号       | 年月日        | 詳細                                                                                      |
|:--------------|:-----------|:----------------------------------------------------------------------------------------|
| **バージョン 1.0** | 2025-04-07 | 初期バージョンとしてファイルを新規作成しました。                                                                |
| **バージョン 2.0** | 2025-05-23 | `print`/`println(Object o)` メソッドを拡張し、各種配列型に対応しました。                                      |
| **バージョン 2.1** | 2025-06-08 | 整数出力のロジックを改善し、パフォーマンスを向上させました。                                                          |
| **バージョン 3.0** | 2025-09-22 | メソッドチェーンに対応し、記述性を向上。`print`/`println`が多様な型をサポート。`Unsafe`利用などで内部ロジックを最適化し、パフォーマンスを改善。    |
| **バージョン 4.0** | 2026-02-15 | `ContestPrinter` と `CompressedFastPrinter` を統合。すべての拡張出力メソッドが `FastPrinter` で利用可能になりました。 |

### バージョン管理について

バージョン番号は2桁で管理します：

- 1桁目（メジャーバージョン）: メソッドの追加や機能拡張があった場合に更新
- 2桁目（マイナーバージョン）: 誤字修正、バグ修正、マイクロ高速化などの小さな更新があった場合に更新
